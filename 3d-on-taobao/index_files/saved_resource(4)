KISSY.add("wangpu/base",function(a){function b(a){var b=this;b._mod=a.mod,b._context=a,b._mod&&b._init()}{var c=document,d=a.DOM;a.Event}return a.augment(b,{_init:function(){a.log("Base init start");var b=this;b.updateToken(),a.log("Base init end")},updateToken:function(){var b=d.get("#J_TokenField");if(b){var e=/_tb_token_=[^&]*/i,f=d.query("a.J_TokenSign",c),g="_tb_token_="+b.value;a.each(f,function(a){var b=a.href;e.test(b)?a.href=b.replace(e,g):a.href+=(-1!==b.lastIndexOf("&")?"&":"?")+g})}}}),b.selector="body",b.type="base",b});KISSY.add("wangpu/decoration/compatible",function(a){function b(d,e){var f={top:"auto",bottom:"auto",left:"auto",right:"auto"};f.top=c.css(d,"top"),f.bottom=c.css(d,"bottom"),"auto"!==f.bottom&&(f.top="auto"),f.left=c.css(d,"left"),f.right=c.css(d,"right"),e=e||{},e=a.merge(b.Config,e),this.offset=f,this.config=e,this.elem=a.get(d),this._init()}var c=a.DOM,d=a.Event,e=/px[;]{0,1}/g,f="//gdp.alicdn.com/tps/i4/T1VhujXXBkXXXXXXXX-1-1.gif",g=!0,h=/\w+\.png$/;return b.Config={fixed:!1,png:!1,png_bg:!1,png_tag:!1,png_method:"crop",maxWidth:!1,maxHeight:!1,minWidth:!1,minHeight:!1,maxWidthValue:0,maxHeightValue:0,minWidthValue:0,minHeightValue:0},a.augment(b,{_init:function(){var a=this,b=a.config;b.fixed&&a._fixIE6PositionFixed(),b.png&&a._fixIE6PngTransparent(),b.maxWidth&&a._isValidWidthValue()&&a._fixMaxWidth(),b.maxHeight&&a._isValidHeightValue()&&a._fixMaxHeight(),b.minWidth&&a._isValidWidthValue()&&a._fixMinWidth(),b.minHeight&&a._isValidHeightValue()&&a._fixMinHeight()},_fixIE6PositionFixed:function(){var a=this;c.css(a.elem,"position","absolute"),d.on(window,"scroll resize",function(b){var d=a.offset.top&&"auto"!==a.offset.top?c.scrollTop()+parseInt(a.offset.top.toString().replace(e,""))+"px":"auto",f=a.offset.bottom&&"auto"!==a.offset.bottom&&"auto"===d?c.scrollTop()+c.viewportHeight()-parseInt(a.offset.bottom.toString().replace(e,""))-c.height(a.elem)+"px":"auto",g=a.offset.left||"auto",h=a.offset.right||"auto";"auto"==d?c.css(a.elem,"top",f):c.css(a.elem,"top",d),c.css(a.elem,"left",g),c.css(a.elem,"right",h),c.css(a.elem,"bottom",f)})},_fixIE6PngTransparent:function(){var a=this,b=a.config;1==b.png_bg&&a._bg_fnFixPng(a.elem,b),1==b.png_tag&&(a._el_fnFixPng(a.elem),!g||"A"!=a.elem.tagName&&"INPUT"!=a.elem.tagName||""!=a.elem.style.position||(a.elem.style.position="relative"),a._childrenFix(a.elem))},_bg_fnFixPng:function(a,b){var c=a.currentStyle.backgroundImage,d=c.substring(5,c.length-2);h.test(d)&&(a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+d+"', sizingMethod='"+b.png_method+"')",a.style.backgroundImage="url("+f+")")},_el_fnFixPng:function(a){var b=a.src;h.test(b)&&(a.style.width=a.width+"px",a.style.height=a.height+"px",a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+b+"', sizingMethod='scale')",a.src=f)},_childrenFix:function(a){for(var b=["a","input","select","textarea","button"],c=b.length;c--;)for(var d=a.all.tags(b[c]),e=d.length;e--;)/relative|absolute/i.test(d[e].currentStyle.position)||(d[e].style.position="relative")},_isValidWidthValue:function(){var a=this,b=a.config;return b.maxWidth&&b.minWidth&&b.maxWidthValue<b.minWidthValue?!1:!0},_isValidHeightValue:function(){var a=this,b=a.config;return b.maxHeight&&b.minHeight&&b.maxHeightValue<b.minHeightValue?!1:!0},_fixMaxWidth:function(){var a=this,b=a.config;a.elem&&c.width(a.elem)>b.maxWidthValue&&c.css(a.elem,"width",b.maxWidthValue+"px")},_fixMaxHeight:function(){var a=this,b=a.config;a.elem&&c.height(a.elem)>b.maxHeightValue&&c.css(a.elem,"height",b.maxHeightValue+"px")},_fixMinHeight:function(){var a=this,b=a.config;a.elem&&c.height(a.elem)<b.minHeightValue&&c.css(a.elem,"height",b.minHeightValue+"px")},_fixMinWidth:function(){var a=this,b=a.config;a.elem&&c.width(a.elem)<b.minWidthValue&&c.css(a.elem,"width",b.minWidthValue+"px")}}),b}),KISSY.add("wangpu/decoration/countdown",function(a){function b(b,c){var d=this;cfg={timeBegin:0,collateurl:"",collateval:0},d.timeStart=new Date,d.config=a.merge(cfg,c||{}),d._countTime(b)}function c(b,d,e){var f={d:".ks-d",h:".ks-h",m:".ks-m",s:".ks-s",i:".ks-i"},g={interval:1e3,timeUnitCls:f,minDigit:2,timeRunCls:".ks-countdown-run",timeEndCls:".ks-countdown-end"},h=a.merge(g,e);h.run&&!a.isFunction(h.run)&&delete h.run,h.end&&!a.isFunction(h.end)&&delete h.end,h.interval=parseInt(h.interval),(isNaN(h.interval)||h.interval<200)&&(h.interval=200),c.superclass.constructor.call(this,d,h),this.counter(b)}function d(b,c){var d=function(b){a.isDate(b)||(b=new Date),a.isFunction(c)&&c(b)};a.io({url:b,type:"HEAD",success:function(a,b,c){d(new Date(c.getResponseHeader("date")))},error:function(){d(new Date)},cache:!1})}function d(b,c){function d(a,b){1e3>a?c(b):3>f?e():c(new Date(b.setMilliseconds(b.getMilliseconds()+a/2)))}function e(){var c=new Date;f++,a.io({url:b,type:"HEAD",success:function(a,b,e){d(new Date-c,new Date(e.getResponseHeader("date")))},error:function(){d()},cache:!1})}var f=0;e()}function e(b,c,e){b="."+(b||"J_TWidget");var g=function(d){a.query(b,c).each(function(b){var c=f.attr(b,"data-widget-type"),e=f.attr(b,"data-widget-config");"Countdown"===c&&(e=a.isNull(e)?{}:JSON.parse(e.replace(/'/g,'"')),d&&a.isDate(d)&&(e.timeBegin=d),new a.Countdown(b,e.endTime,e))})};e?d(e,g):g()}var f=a.DOM,g={d:864e5,h:36e5,m:6e4,s:1e3,i:1},h=["d","h","m","s","i"];return b.prototype={_countTime:function(b){var c=this,d=c.config,e=d.timeBegin,f=0;if(/^(\d{4})\-(\d{1,2})\-(\d{1,2})(\s+)(\d{1,2}):(\d{1,2}):(\d{1,2})$/gi.test(b.replace(/\./g,"-"))){var g=b.match(/\d+/g);b=new Date(g[0],g[1]-1,g[2],g[3],g[4],g[5])}else/^\d+&/.test(b)&&(b=parseInt(b));f=a.isNull(e)||isNaN(e)||0>=e?a.isDate(b)?b-new Date:parseInt(b):typeof e==typeof b?b-e:0,(!a.isNumber(f)||0>f)&&(f=0),c.timeRemain=f},getRemain:function(){var a=parseInt(this.timeRemain-(new Date-this.timeStart));return isNaN(a)||0>=a?0:a},format:function(b){var c=Array.prototype.slice.call(arguments,1),d=[];return a.each(c,function(a){if(g[a]){var c=Math.floor(b/g[a]);b-=c*g[a],d.push(c)}}),d},fetch:function(a,b,c){var d=this,e=setInterval(function(){var a=d.getRemain();a>0?b&&b.call(d,a):(b&&b.call(d,0),c&&c.call(d),clearInterval(e))},a)}},a.extend(c,b,{counter:function(b){var c=this,d=c.config,e=function(b){var e=[b].concat(l),f=c.format.apply(this,e);a.each(k,function(a,b){a.text(f[b])}),d.run&&d.run.call(c,e,f)},f=function(){i.hide(),j.show(),d.end&&d.end.call(c)},g=d.timeUnitCls,b=a.one(b),i=b.all(d.timeRunCls),j=b.all(d.timeEndCls),k=[],l=[];a.each(h,function(a){g[a]&&b.one(g[a])&&(k.push(b.one(g[a])),l.push(a))}),i.show(),j.hide(),c.fetch(d.interval,e,f)}}),c.autoRender=e,c.Core=b,c.getServerTime=d,a.Countdown=c,c}),KISSY.add("wangpu/decoration/isv",function(a){TB.namespace("ISV");var b=[{isvParam:"u_name/u_visitor/u_item_id/u_item_num_id/u_aload_id/u_session/u_preurl/u_curl/u_title/u_time",isvUrl:""}],a=KISSY,c=window,d=document,e=function(){var e={},f=/^(https?\:)?\/\/[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,3}(\/\S*)?$/,g=function(a){return!0===e.debugMode&&alert(a),!1},h=function(a){if(0<d.cookie.length){var b=d.cookie.match(new RegExp("(^| )"+a+"=([^;]*)(;|$)"));return null===b?"":b[2]}return""},i=function(){return Math.ceil(1e9*Math.random()).toString()},j=function(){return(+new Date).toString().substring(0,10)},k=function(){var a="";try{""!==d.referrer?a=d.referrer:null!==c.opener&&void 0!==c.opener?a=(c.opener.document||0).URL||"":null!==c.parent&&(a=c.parent.document.URL,a===d.URL&&(a=d.referrer))}catch(b){}return a},l=function(a){var b=j(),c=[i(),"0",b];return c.join("_")},m=function(a){for(var b={u_name:e.nickName.toString(),u_item_id:e.itemId.toString(),u_item_num_id:e.itemNumId.toString(),u_template_name:e.templateName.toString(),u_template_id:e.templateId.toString(),u_visitor:h(e.cnaCookieName),u_session:l(a),u_preurl:encodeURIComponent(k()),u_curl:encodeURIComponent(d.URL),u_title:encodeURIComponent(d.title),u_aload_id:c.acookie_load_id||"",u_time:j()},i=[],m=0,n=a.length;n>m;m++){var o=a[m];if(String===o.isvUrl.constructor&&String===o.isvParam.constructor&&!0===f.test(o.isvUrl)&&!1!==o.isvParam.indexOf("_")){var p=o.isvParam.toLowerCase().replace(/\s+/g,"").split("/");if(0<p.length){for(var q="",r=0,s=p.length;s>r;r++){var t=p[r];void 0!==b[t]&&(q+="&"+t+"="+b[t])}""!==q&&(q=q.replace("&","?"),i[m]=new Image(1,1),i[m].src=o.isvUrl+q,i[m].onload=function(){return g("Send Successfully")})}}}},n=function(){if("-1"===e.shopStats||"-2"==e.shopStats||isNaN(e.shopStats))a.log(e.validatorUrl+"?nickName="+e.nickName.toString()+"&userId="+e.userId.toString()+"&itemNumId="+e.itemNumId.toString()+"&shopId="+e.shopId.toString()+"&siteId="+e.siteId.toString()+"&shopStats="+e.shopStats.toString()),a.getScript(e.validatorUrl+"?nickName="+e.nickName.toString()+"&userId="+e.userId.toString()+"&itemNumId="+e.itemNumId.toString()+"&shopId="+e.shopId.toString()+"&siteId="+e.siteId.toString()+"&shopStats="+e.shopStats.toString(),function(){if(void 0===TB.ISV.Data||Array!==TB.ISV.Data.constructor||0===TB.ISV.Data.length)return g("Cannot get the valid data");var a=TB.ISV.Data;delete TB.ISV.Data,m(a)});else if(e.shopStats>0){var c,d=[],f=parseInt(e.shopStats);for(c=0;c<b.length;c++)(f&Math.pow(2,c))>0&&d.push(b[c]);m(d)}};return{init:function(b){if(e=b||{},a.mix(e,{nickName:"",userId:"",shopId:"",templateName:"",templateId:"",itemId:"",itemNumId:"",siteId:"",shopStats:"-2",cnaCookieName:"cna",sessionLife:1400,validatorUrl:"//store.taobao.com/tadget/shop_stats.htm",debugMode:!1},!1),""===e.itemId&&-1!==d.URL.indexOf("?taomi=")){var c=$("J_FrmBid");null!==c&&c.elements.item_id&&(e.itemId=c.elements.item_id.value)}switch(!0){case""===e.nickName&&""===e.userId&&""===e.shopId:return g("nickName and userId and shopId are all null");case""===e.cnaCookieName:return g("cnaCookieName is null");case Number!==e.sessionLife.constructor:return g("sessionLife is not a number");case!1===f.test(e.validatorUrl):return g("validatorUrl is not a valid url")}n()}}}();return e}),KISSY.add("wangpu/decoration/shopmonitor",function(a){function b(){var b=this;try{a.later(function(){window.goldlog?b._init():a.later(arguments.callee,500)},500)}catch(c){a.log("\u5e97\u94fa\u9ec4\u91d1\u77ff\u5de5\u57cb\u70b9\u51fa\u9519")}}{var c=a.DOM,d=(a.Event,a.UA,window.g_hb_monitor_st||+new Date,!!c.get("#shop-head"));!d&&!c.get("#J_ShopSearchResult")}return a.augment(b,{_init:function(){var b=this;try{a.each(b._monitor_func_list,function(a){a.call(b)})}catch(c){window.goldlog.emit("shop_monitor_error",{error:c}),a.error(c)}},_monitor_func_list:[function(){KISSY&&KISSY.DOM&&window.screen&&!(Math.random()>.005)&&window.goldlog.emit("viewport-analysis2",{"viewport-w":KISSY.DOM.viewportWidth(),"viewport-h":KISSY.DOM.viewportHeight(),"screen-w":window.screen.width,"screen-h":window.screen.height,"avail-w":window.screen.availWidth,"avail-h":window.screen.availHeight,"browser-w":window.outerWidth||0,"browser-h":window.outerHeight||0})},function(){var a=Math.random();if(KISSY&&KISSY.IO&&!(a>.01)){var b,c,d=a*Math.pow(10,18),e="shop_onbeforeunload",f=window.onbeforeunload,g="//gm.mmstat.com/ued.1.1.2?type=9&_gm:id="+e+"&pageid="+d,h=new Image;switch(c=.002>a?"tmp_new_image":.004>a?"body_image":.006>a?"kissy_sync_ajax":.008>a?"goldminer":"kissy_jsonp",window.goldlog.emit(e,{pageid:d,stype:c,skey:1}),c){case"tmp_new_image":b=function(){h.src=g+"&stype=tmp_new_image"};break;case"body_image":h.style.cssText="display:none",document.body.appendChild(h),b=function(){h.src=g+"&stype=body_image"};break;case"kissy_sync_ajax":b=function(){KISSY.IO({url:g,data:{stype:"kissy_sync_ajax"},async:!1})};break;case"goldminer":b=function(){goldlog.emit(e,{stype:"goldminer"})};break;default:b=function(){KISSY.IO.jsonp(g,{stype:"kissy_jsonp"})}}window.onbeforeunload=function(){f&&f(),b()}}}]}),b}),KISSY.add("wangpu/decoration/shopisv",function(a,b,c,d,e,f){var g=f.Dialog,h=c.all,i=location.host.indexOf("daily.taobao.net")>=0,j=window.shop_config&&window.shop_config.isPreview,k=document.referrer.indexOf("1111.tmall.com")>0,l={init:function(){var a=this,b=window.login_config&&window.login_config.isInternal,c=window.login_config&&window.login_config.isAudit;j||c||i||b||(a.filterExpiredPages(),a.filterExpiredModules())},initGameMask:function(){var b=this;h(".tb-isvgamemodule").length>0&&(k&&b.autoShowGame(),a.UA.ipad>0||parseInt(a.UA.ie)<9&&parseInt(a.UA.ie)>0?b.addLink():(b.addMask(),b.bindEvent()))},filterExpiredPages:function(){a.each(d.query("meta"),function(b){if("microscope-data"==d.attr(b,"name")){var c=a.unparam(d.attr(b,"content"),";","="),e=c&&c.startTime,f=c&&c.deadTime,g=a.now();e&&(e=new Date(e.replace("-"," ")).getTime(),e>g&&(window.location.href=decodeURIComponent("//"+window.location.host))),f&&(f=new Date(f.replace("-"," ")).getTime(),g>f&&(window.location.href=decodeURIComponent("//"+window.location.host)))}})},filterExpiredModules:function(){a.each(d.query(".J_TModule"),function(b){var c=d.attr(b,"data-startTime"),e=d.attr(b,"data-deadTime"),f=a.now();c&&(c=new Date(c.replace("-"," ")).getTime(),c>f&&d.remove(b)),e&&(e=new Date(e.replace("-"," ")).getTime(),f>e&&d.remove(b))})},addMask:function(){h(".tb-isvgamemodule").each(function(a){if(!h(a).contains(".tb-isvgamemodule-mask")){var b=d.create('<div class="tb-isvgamemodule-mask"></div>'),c=h(this).width(),e=h(this).height();d.css(b,{width:c,height:e,position:"absolute",top:"0",left:"0",cursor:"pointer",background:"url(//gtms04.alicdn.com/tps/i4/TB1LbDVGFXXXXb.XpXXaCx9JFXX-1-1.png) 0 0 repeat"}),h(a).css({position:"relative"}).prepend(h(b))}})},addLink:function(){h(".tb-isvgamemodule").each(function(a){var b=h(a).html(),c=h(a).attr("data-iframe-url");h(a).html('<a href="'+c+'" target="_blank">'+b+"</a>")})},bindEvent:function(){var c=this;setTimeout(function(){b.delegate(document,"click",".tb-isvgamemodule",function(b){b.preventDefault(),a.UA.safari>0?c.fixSafariCookie(d.parent(b.target)):c.showDialog(d.parent(b.target))})},0)},fixSafariCookie:function(a){var b=d.attr(a,"data-iframe-url");window.showModalDialog(b,{name:""},"dialogWidth=870px;dialogHeight=580px")},autoShowGame:function(){var a=this;a.showDialog(d.get(".tb-isvgamemodule"))},showDialog:function(c){var e=d.attr(c,"data-iframe-url"),f=h(window).height(),i=580,j="<iframe src="+e+" width='872' height='580' frameborder='no' border='0' name='isvPage'></iframe>",k="",l='<div class="tm-j-close-isv-btn"></div>';f>650&&(i=650,k='<img src="//gtms01.alicdn.com/tps/i1/TB1GP0pGFXXXXaqXXXX86UL.pXX-870-70.png" width="870" alt="isv header"/>');var m=new g({prefixCls:"tm-isv-",elCls:"tm-shop-isv-dialog",width:872,height:i,closable:!1,closeOnClick:!0,closeAction:"destroy",elStyle:{position:6==a.UA.ie?"absolute":"fixed"},headerContent:k,bodyContent:j,footerContent:l,showCat:!1,mask:!0,zIndex:9999,align:{points:["cc","cc"]}});m.render(),m.show(),m.get("el").css("z-index",99999);var n=d.create("<div class='tm-isv-flower-mask'></div>");d.append(n,document.body),b.delegate(m.get("el"),"click",".tm-j-close-isv-btn",function(a){m.destroy(),d.remove(n)}),b.on(window,"resize",function(){})}};return l},{requires:["event","node","dom","ajax","overlay","./shopisv.css"]}),KISSY.add("wangpu/decoration/vdata",function(a,b){return{init:function(c){var d=a.one("#J_TokenField");return a.log("VData init start"),window.login_config?void c():void b({dataType:"jsonp",url:"//store.taobao.com/i/vdata.htm",success:function(a){window.login_config=a,d&&d.val(a.tbToken),c()}})}}},{requires:["ajax"]}),KISSY.add("wangpu/decoration/init",function(a,b,c,d,e,f,g,h,i,j){function k(a){var b=this;b._mod=a.mod,b._context=a,b._mod&&b._init()}var l=(document,a.DOM),m=a.Event;return a.augment(k,{_init:function(){var b=this;a.ready(function(){var c=(new Date).getTime();a.log("Decoration init start"),b.initPicLazyload(),b.initWidget("J_TWidget"),b.initCartPlugin(),b.initISV();var d=b._context.pageType;("wangpu"==d||"tmall"==d)&&j.init(function(){b.initShopIsv(),b.initBuriedStatistics(),b.handleDesignEntr()}),("wangpu"==d||"cdetail"==d)&&b.initSNS(),"wangpu"==d&&b.initTmallCoupon();var e=(new Date).getTime();a.log("Decoration init end"),a.log("Decoration init spend time ms:"+(e-c))})},initTmallCoupon:function(){l.query(".J_CouponItem").length>0&&a.getScript("//g.alicdn.com/??mui/seed/1.4.5/seed.js",function(){a.getScript("//g.alicdn.com/mui/seed-g/1.0.40/seed.js",function(){a.use("mui/coupon",function(a,b){new b({cls:"J_CouponItem"})})})})},initWidget:function(f,g){function h(){a.later(function(){if(0!==p.length){try{i(p.shift())}catch(b){a.log("\u521d\u59cb\u5316\u7ec4\u4ef6\u51fa\u9519")}h()}},0)}function i(c){var f,g=c.getAttribute("data-widget-type");if(g)try{switch(f=c.getAttribute("data-widget-config"),f&&(f=f.replace(/'/g,'"')),f=a.JSON.parse(f),!0){case o.switchable.indexOf(g)>-1:j(c,a.merge(b.Config,a.merge(b[g].Config,f))),"Carousel"!=g||l.get("."+f.prevBtnCls,c)&&l.get("."+f.nextBtnCls,c)?new b[g](c,a.merge(f,{lazyDataType:"img-src"})):new b(c,a.merge(f,{lazyDataType:"img-src"}));break;case o.overlay.indexOf(g)>-1:k(f,c);break;case o.compatible.indexOf(g)>-1:a.UA.ie&&a.UA.ie<7&&new d(c,f);break;case o.countdown.indexOf(g)>-1:new e(c,f.endTime,f);break;default:a.log("\u5728kissy\u5e93\u4e2d\u6ca1\u6709\u67e5\u627e\u5230\u4f60\u60f3\u8981\u521d\u59cb\u5316\u7684\u7ec4\u4ef6")}}catch(h){a.log("widget "+h,"warn")}}function j(b,c){var d=c.activeIndex;d>-1||"number"==typeof c.switchTo||(d=0);var e,f,g=".",h=c.steps,i=d*h,j=[];switch(c.markupType){case 0:e=l.get(g+c.contentCls,b),f=l.children(e);break;case 1:f=l.query(g+c.panelCls,b);break;case 2:f=c.panels}a.each(f,function(b,c){c>=i&&i+h>c?a.each(l.query("img",b),function(a){l.attr(a,"data-ks-lazyload")&&(l.attr(a,"src",l.attr(a,"data-ks-lazyload")),l.removeAttr(a,"data-ks-lazyload"))}):j=j.concat(l.query("img",b))}),a.each(j,function(a){l.attr(a,"data-ks-lazyload")&&(l.attr(a,"data-ks-lazyload-custom",l.attr(a,"data-ks-lazyload")),l.removeAttr(a,"data-ks-lazyload"))})}function k(b,d){if("type"in b||(b.type=b.content?"multi-one":"one-one"),b.triggerType||(b.triggerType="mouse"),(!b.zIndex||b.zIndex>1e8-100||b.zIndex<1e8-200)&&(b.zIndex=1e8-200),"one-one"==b.type)if(a.version.indexOf("1.4")>=0){l.hide(d);var e=d.style.cssText.replace(/visibility\:\s*hidden(\s*;)?/i,"");d.style.cssText=e,l.addClass(d,"hidden"),l.html(d,'<div class="ks-popup-content">'+l.html(d)+"</div>"),l.addClass(d,"tb-shop-popup-show"),l.css(d,{display:"block",position:"absolute",left:"-9999px",top:"-9999px",zIndex:b.zIndex}),new c.Popup({trigger:l.get(b.trigger,n._mod),triggerType:b.triggerType,srcNode:d,align:b.align,zIndex:b.zIndex})}else new c.Popup({trigger:l.get(b.trigger,n._mod),triggerType:b.triggerType,srcNode:d,elStyle:{display:"block",visibility:"hidden",position:"absolute",left:"-9999px",top:"-9999px"},align:b.align,zIndex:b.zIndex});else{var f=new c({effect:b.effect?b.effect:{},zIndex:b.zIndex}),g=l.get(b.container),h=l.query(b.trigger,g),i=l.query(b.content,g);a.each(h,function(c,d){var e,g;m.on(c,"mouseenter",function(){e&&e.cancel(),e=a.later(function(){i[d]&&(f.set("content",i[d].value),f.set("align",a.merge(b.align,{node:c})),f.show()),e.cancel()},100)}),m.on(c,"mouseleave",function(){g&&g.cancel(),g=a.later(function(){f.hide(),g.cancel()},100)})})}}var n=this;f="."+(f||"KS_Widget");var o={switchable:"Tabs Slide Carousel Accordion",overlay:"Popup",compatible:"Compatible",countdown:"Countdown"},p=a.query(f,"#content");h()},initSNS:function(){var b,c;if(b=l.query(".sns-widget",self._mod))if(window.SNS)for(c=0;c<b.length;c++)SNS.active(b[c]);else{a.getScript("//assets.alicdn.com/p/snsdk/shop-core.js?t=20140530",function(){for(c=0;c<b.length;c++)SNS.active(b[c])})}},initCartPlugin:function(){var b=this;l.get(".J_CartPluginTrigger")&&a.use("tbc/add-to-cart/0.1.7/",function(a,c){c.init(b._mod,{preventAll:!0})})},preprocessImg:function(){var b=[],c=0,d=0;a.isArray(this._context.lazyContainers)?b=this._context.lazyContainers:b[0]=this._context.lazyContainers,a.each(b,function(b){a.each(l.query("img",b),function(a){!a.offsetWidth&&l.attr(a,"data-ks-lazyload")&&(l.attr(a,"src",l.attr(a,"data-ks-lazyload")),l.removeAttr(a,"data-ks-lazyload"),d++),c++})}),a.log("img nums:"+c),a.log("display none img nums:"+d)},initPicLazyload:function(){this.preprocessImg(),new f(this._context.lazyContainers,{mod:"manual",diff:{left:9999,right:9999,top:0,bottom:500}})},initBuriedStatistics:function(){a.getScript("//assets.alicdn.com/apps/lz/hc.js?v=5"),a.getScript("//assets.alicdn.com/s/tb-tracer-min.js?t=20110628"),new h},initISV:function(){g.init(this._context.isvParams)},handleDesignEntr:function(){window.shop_config&&window.login_config&&window.shop_config.userId==window.login_config.loginUserId&&(l.show(l.get("#J_DesignPage")),l.show(l.query("#copyright .J_TShowForSeller")))},initShopIsv:function(){i.init()}}),k.selector="#content",k.type="decoration",k},{requires:["switchable","overlay","./compatible","./countdown","datalazyload","./isv","./shopmonitor","./shopisv","./vdata"]});KISSY.add("wangpu/decoration/compatible",function(a){function b(d,e){var f={top:"auto",bottom:"auto",left:"auto",right:"auto"};f.top=c.css(d,"top"),f.bottom=c.css(d,"bottom"),"auto"!==f.bottom&&(f.top="auto"),f.left=c.css(d,"left"),f.right=c.css(d,"right"),e=e||{},e=a.merge(b.Config,e),this.offset=f,this.config=e,this.elem=a.get(d),this._init()}var c=a.DOM,d=a.Event,e=/px[;]{0,1}/g,f="//gdp.alicdn.com/tps/i4/T1VhujXXBkXXXXXXXX-1-1.gif",g=!0,h=/\w+\.png$/;return b.Config={fixed:!1,png:!1,png_bg:!1,png_tag:!1,png_method:"crop",maxWidth:!1,maxHeight:!1,minWidth:!1,minHeight:!1,maxWidthValue:0,maxHeightValue:0,minWidthValue:0,minHeightValue:0},a.augment(b,{_init:function(){var a=this,b=a.config;b.fixed&&a._fixIE6PositionFixed(),b.png&&a._fixIE6PngTransparent(),b.maxWidth&&a._isValidWidthValue()&&a._fixMaxWidth(),b.maxHeight&&a._isValidHeightValue()&&a._fixMaxHeight(),b.minWidth&&a._isValidWidthValue()&&a._fixMinWidth(),b.minHeight&&a._isValidHeightValue()&&a._fixMinHeight()},_fixIE6PositionFixed:function(){var a=this;c.css(a.elem,"position","absolute"),d.on(window,"scroll resize",function(b){var d=a.offset.top&&"auto"!==a.offset.top?c.scrollTop()+parseInt(a.offset.top.toString().replace(e,""))+"px":"auto",f=a.offset.bottom&&"auto"!==a.offset.bottom&&"auto"===d?c.scrollTop()+c.viewportHeight()-parseInt(a.offset.bottom.toString().replace(e,""))-c.height(a.elem)+"px":"auto",g=a.offset.left||"auto",h=a.offset.right||"auto";"auto"==d?c.css(a.elem,"top",f):c.css(a.elem,"top",d),c.css(a.elem,"left",g),c.css(a.elem,"right",h),c.css(a.elem,"bottom",f)})},_fixIE6PngTransparent:function(){var a=this,b=a.config;1==b.png_bg&&a._bg_fnFixPng(a.elem,b),1==b.png_tag&&(a._el_fnFixPng(a.elem),!g||"A"!=a.elem.tagName&&"INPUT"!=a.elem.tagName||""!=a.elem.style.position||(a.elem.style.position="relative"),a._childrenFix(a.elem))},_bg_fnFixPng:function(a,b){var c=a.currentStyle.backgroundImage,d=c.substring(5,c.length-2);h.test(d)&&(a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+d+"', sizingMethod='"+b.png_method+"')",a.style.backgroundImage="url("+f+")")},_el_fnFixPng:function(a){var b=a.src;h.test(b)&&(a.style.width=a.width+"px",a.style.height=a.height+"px",a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+b+"', sizingMethod='scale')",a.src=f)},_childrenFix:function(a){for(var b=["a","input","select","textarea","button"],c=b.length;c--;)for(var d=a.all.tags(b[c]),e=d.length;e--;)/relative|absolute/i.test(d[e].currentStyle.position)||(d[e].style.position="relative")},_isValidWidthValue:function(){var a=this,b=a.config;return b.maxWidth&&b.minWidth&&b.maxWidthValue<b.minWidthValue?!1:!0},_isValidHeightValue:function(){var a=this,b=a.config;return b.maxHeight&&b.minHeight&&b.maxHeightValue<b.minHeightValue?!1:!0},_fixMaxWidth:function(){var a=this,b=a.config;a.elem&&c.width(a.elem)>b.maxWidthValue&&c.css(a.elem,"width",b.maxWidthValue+"px")},_fixMaxHeight:function(){var a=this,b=a.config;a.elem&&c.height(a.elem)>b.maxHeightValue&&c.css(a.elem,"height",b.maxHeightValue+"px")},_fixMinHeight:function(){var a=this,b=a.config;a.elem&&c.height(a.elem)<b.minHeightValue&&c.css(a.elem,"height",b.minHeightValue+"px")},_fixMinWidth:function(){var a=this,b=a.config;a.elem&&c.width(a.elem)<b.minWidthValue&&c.css(a.elem,"width",b.minWidthValue+"px")}}),b});KISSY.add("wangpu/decoration/countdown",function(a){function b(b,c){var d=this;cfg={timeBegin:0,collateurl:"",collateval:0},d.timeStart=new Date,d.config=a.merge(cfg,c||{}),d._countTime(b)}function c(b,d,e){var f={d:".ks-d",h:".ks-h",m:".ks-m",s:".ks-s",i:".ks-i"},g={interval:1e3,timeUnitCls:f,minDigit:2,timeRunCls:".ks-countdown-run",timeEndCls:".ks-countdown-end"},h=a.merge(g,e);h.run&&!a.isFunction(h.run)&&delete h.run,h.end&&!a.isFunction(h.end)&&delete h.end,h.interval=parseInt(h.interval),(isNaN(h.interval)||h.interval<200)&&(h.interval=200),c.superclass.constructor.call(this,d,h),this.counter(b)}function d(b,c){var d=function(b){a.isDate(b)||(b=new Date),a.isFunction(c)&&c(b)};a.io({url:b,type:"HEAD",success:function(a,b,c){d(new Date(c.getResponseHeader("date")))},error:function(){d(new Date)},cache:!1})}function d(b,c){function d(a,b){1e3>a?c(b):3>f?e():c(new Date(b.setMilliseconds(b.getMilliseconds()+a/2)))}function e(){var c=new Date;f++,a.io({url:b,type:"HEAD",success:function(a,b,e){d(new Date-c,new Date(e.getResponseHeader("date")))},error:function(){d()},cache:!1})}var f=0;e()}function e(b,c,e){b="."+(b||"J_TWidget");var g=function(d){a.query(b,c).each(function(b){var c=f.attr(b,"data-widget-type"),e=f.attr(b,"data-widget-config");"Countdown"===c&&(e=a.isNull(e)?{}:JSON.parse(e.replace(/'/g,'"')),d&&a.isDate(d)&&(e.timeBegin=d),new a.Countdown(b,e.endTime,e))})};e?d(e,g):g()}var f=a.DOM,g={d:864e5,h:36e5,m:6e4,s:1e3,i:1},h=["d","h","m","s","i"];return b.prototype={_countTime:function(b){var c=this,d=c.config,e=d.timeBegin,f=0;if(/^(\d{4})\-(\d{1,2})\-(\d{1,2})(\s+)(\d{1,2}):(\d{1,2}):(\d{1,2})$/gi.test(b.replace(/\./g,"-"))){var g=b.match(/\d+/g);b=new Date(g[0],g[1]-1,g[2],g[3],g[4],g[5])}else/^\d+&/.test(b)&&(b=parseInt(b));f=a.isNull(e)||isNaN(e)||0>=e?a.isDate(b)?b-new Date:parseInt(b):typeof e==typeof b?b-e:0,(!a.isNumber(f)||0>f)&&(f=0),c.timeRemain=f},getRemain:function(){var a=parseInt(this.timeRemain-(new Date-this.timeStart));return isNaN(a)||0>=a?0:a},format:function(b){var c=Array.prototype.slice.call(arguments,1),d=[];return a.each(c,function(a){if(g[a]){var c=Math.floor(b/g[a]);b-=c*g[a],d.push(c)}}),d},fetch:function(a,b,c){var d=this,e=setInterval(function(){var a=d.getRemain();a>0?b&&b.call(d,a):(b&&b.call(d,0),c&&c.call(d),clearInterval(e))},a)}},a.extend(c,b,{counter:function(b){var c=this,d=c.config,e=function(b){var e=[b].concat(l),f=c.format.apply(this,e);a.each(k,function(a,b){a.text(f[b])}),d.run&&d.run.call(c,e,f)},f=function(){i.hide(),j.show(),d.end&&d.end.call(c)},g=d.timeUnitCls,b=a.one(b),i=b.all(d.timeRunCls),j=b.all(d.timeEndCls),k=[],l=[];a.each(h,function(a){g[a]&&b.one(g[a])&&(k.push(b.one(g[a])),l.push(a))}),i.show(),j.hide(),c.fetch(d.interval,e,f)}}),c.autoRender=e,c.Core=b,c.getServerTime=d,a.Countdown=c,c});KISSY.add("wangpu/decoration/isv",function(a){TB.namespace("ISV");var b=[{isvParam:"u_name/u_visitor/u_item_id/u_item_num_id/u_aload_id/u_session/u_preurl/u_curl/u_title/u_time",isvUrl:""}],a=KISSY,c=window,d=document,e=function(){var e={},f=/^(https?\:)?\/\/[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,3}(\/\S*)?$/,g=function(a){return!0===e.debugMode&&alert(a),!1},h=function(a){if(0<d.cookie.length){var b=d.cookie.match(new RegExp("(^| )"+a+"=([^;]*)(;|$)"));return null===b?"":b[2]}return""},i=function(){return Math.ceil(1e9*Math.random()).toString()},j=function(){return(+new Date).toString().substring(0,10)},k=function(){var a="";try{""!==d.referrer?a=d.referrer:null!==c.opener&&void 0!==c.opener?a=(c.opener.document||0).URL||"":null!==c.parent&&(a=c.parent.document.URL,a===d.URL&&(a=d.referrer))}catch(b){}return a},l=function(a){var b=j(),c=[i(),"0",b];return c.join("_")},m=function(a){for(var b={u_name:e.nickName.toString(),u_item_id:e.itemId.toString(),u_item_num_id:e.itemNumId.toString(),u_template_name:e.templateName.toString(),u_template_id:e.templateId.toString(),u_visitor:h(e.cnaCookieName),u_session:l(a),u_preurl:encodeURIComponent(k()),u_curl:encodeURIComponent(d.URL),u_title:encodeURIComponent(d.title),u_aload_id:c.acookie_load_id||"",u_time:j()},i=[],m=0,n=a.length;n>m;m++){var o=a[m];if(String===o.isvUrl.constructor&&String===o.isvParam.constructor&&!0===f.test(o.isvUrl)&&!1!==o.isvParam.indexOf("_")){var p=o.isvParam.toLowerCase().replace(/\s+/g,"").split("/");if(0<p.length){for(var q="",r=0,s=p.length;s>r;r++){var t=p[r];void 0!==b[t]&&(q+="&"+t+"="+b[t])}""!==q&&(q=q.replace("&","?"),i[m]=new Image(1,1),i[m].src=o.isvUrl+q,i[m].onload=function(){return g("Send Successfully")})}}}},n=function(){if("-1"===e.shopStats||"-2"==e.shopStats||isNaN(e.shopStats))a.log(e.validatorUrl+"?nickName="+e.nickName.toString()+"&userId="+e.userId.toString()+"&itemNumId="+e.itemNumId.toString()+"&shopId="+e.shopId.toString()+"&siteId="+e.siteId.toString()+"&shopStats="+e.shopStats.toString()),a.getScript(e.validatorUrl+"?nickName="+e.nickName.toString()+"&userId="+e.userId.toString()+"&itemNumId="+e.itemNumId.toString()+"&shopId="+e.shopId.toString()+"&siteId="+e.siteId.toString()+"&shopStats="+e.shopStats.toString(),function(){if(void 0===TB.ISV.Data||Array!==TB.ISV.Data.constructor||0===TB.ISV.Data.length)return g("Cannot get the valid data");var a=TB.ISV.Data;delete TB.ISV.Data,m(a)});else if(e.shopStats>0){var c,d=[],f=parseInt(e.shopStats);for(c=0;c<b.length;c++)(f&Math.pow(2,c))>0&&d.push(b[c]);m(d)}};return{init:function(b){if(e=b||{},a.mix(e,{nickName:"",userId:"",shopId:"",templateName:"",templateId:"",itemId:"",itemNumId:"",siteId:"",shopStats:"-2",cnaCookieName:"cna",sessionLife:1400,validatorUrl:"//store.taobao.com/tadget/shop_stats.htm",debugMode:!1},!1),""===e.itemId&&-1!==d.URL.indexOf("?taomi=")){var c=$("J_FrmBid");null!==c&&c.elements.item_id&&(e.itemId=c.elements.item_id.value)}switch(!0){case""===e.nickName&&""===e.userId&&""===e.shopId:return g("nickName and userId and shopId are all null");case""===e.cnaCookieName:return g("cnaCookieName is null");case Number!==e.sessionLife.constructor:return g("sessionLife is not a number");case!1===f.test(e.validatorUrl):return g("validatorUrl is not a valid url")}n()}}}();return e});KISSY.add("wangpu/decoration/shopmonitor",function(a){function b(){var b=this;try{a.later(function(){window.goldlog?b._init():a.later(arguments.callee,500)},500)}catch(c){a.log("\u5e97\u94fa\u9ec4\u91d1\u77ff\u5de5\u57cb\u70b9\u51fa\u9519")}}{var c=a.DOM,d=(a.Event,a.UA,window.g_hb_monitor_st||+new Date,!!c.get("#shop-head"));!d&&!c.get("#J_ShopSearchResult")}return a.augment(b,{_init:function(){var b=this;try{a.each(b._monitor_func_list,function(a){a.call(b)})}catch(c){window.goldlog.emit("shop_monitor_error",{error:c}),a.error(c)}},_monitor_func_list:[function(){KISSY&&KISSY.DOM&&window.screen&&!(Math.random()>.005)&&window.goldlog.emit("viewport-analysis2",{"viewport-w":KISSY.DOM.viewportWidth(),"viewport-h":KISSY.DOM.viewportHeight(),"screen-w":window.screen.width,"screen-h":window.screen.height,"avail-w":window.screen.availWidth,"avail-h":window.screen.availHeight,"browser-w":window.outerWidth||0,"browser-h":window.outerHeight||0})},function(){var a=Math.random();if(KISSY&&KISSY.IO&&!(a>.01)){var b,c,d=a*Math.pow(10,18),e="shop_onbeforeunload",f=window.onbeforeunload,g="//gm.mmstat.com/ued.1.1.2?type=9&_gm:id="+e+"&pageid="+d,h=new Image;switch(c=.002>a?"tmp_new_image":.004>a?"body_image":.006>a?"kissy_sync_ajax":.008>a?"goldminer":"kissy_jsonp",window.goldlog.emit(e,{pageid:d,stype:c,skey:1}),c){case"tmp_new_image":b=function(){h.src=g+"&stype=tmp_new_image"};break;case"body_image":h.style.cssText="display:none",document.body.appendChild(h),b=function(){h.src=g+"&stype=body_image"};break;case"kissy_sync_ajax":b=function(){KISSY.IO({url:g,data:{stype:"kissy_sync_ajax"},async:!1})};break;case"goldminer":b=function(){goldlog.emit(e,{stype:"goldminer"})};break;default:b=function(){KISSY.IO.jsonp(g,{stype:"kissy_jsonp"})}}window.onbeforeunload=function(){f&&f(),b()}}}]}),b});KISSY.add("wangpu/decoration/shopisv",function(a,b,c,d,e,f){var g=f.Dialog,h=c.all,i=location.host.indexOf("daily.taobao.net")>=0,j=window.shop_config&&window.shop_config.isPreview,k=document.referrer.indexOf("1111.tmall.com")>0,l={init:function(){var a=this,b=window.login_config&&window.login_config.isInternal,c=window.login_config&&window.login_config.isAudit;j||c||i||b||(a.filterExpiredPages(),a.filterExpiredModules())},initGameMask:function(){var b=this;h(".tb-isvgamemodule").length>0&&(k&&b.autoShowGame(),a.UA.ipad>0||parseInt(a.UA.ie)<9&&parseInt(a.UA.ie)>0?b.addLink():(b.addMask(),b.bindEvent()))},filterExpiredPages:function(){a.each(d.query("meta"),function(b){if("microscope-data"==d.attr(b,"name")){var c=a.unparam(d.attr(b,"content"),";","="),e=c&&c.startTime,f=c&&c.deadTime,g=a.now();e&&(e=new Date(e.replace("-"," ")).getTime(),e>g&&(window.location.href=decodeURIComponent("//"+window.location.host))),f&&(f=new Date(f.replace("-"," ")).getTime(),g>f&&(window.location.href=decodeURIComponent("//"+window.location.host)))}})},filterExpiredModules:function(){a.each(d.query(".J_TModule"),function(b){var c=d.attr(b,"data-startTime"),e=d.attr(b,"data-deadTime"),f=a.now();c&&(c=new Date(c.replace("-"," ")).getTime(),c>f&&d.remove(b)),e&&(e=new Date(e.replace("-"," ")).getTime(),f>e&&d.remove(b))})},addMask:function(){h(".tb-isvgamemodule").each(function(a){if(!h(a).contains(".tb-isvgamemodule-mask")){var b=d.create('<div class="tb-isvgamemodule-mask"></div>'),c=h(this).width(),e=h(this).height();d.css(b,{width:c,height:e,position:"absolute",top:"0",left:"0",cursor:"pointer",background:"url(//gtms04.alicdn.com/tps/i4/TB1LbDVGFXXXXb.XpXXaCx9JFXX-1-1.png) 0 0 repeat"}),h(a).css({position:"relative"}).prepend(h(b))}})},addLink:function(){h(".tb-isvgamemodule").each(function(a){var b=h(a).html(),c=h(a).attr("data-iframe-url");h(a).html('<a href="'+c+'" target="_blank">'+b+"</a>")})},bindEvent:function(){var c=this;setTimeout(function(){b.delegate(document,"click",".tb-isvgamemodule",function(b){b.preventDefault(),a.UA.safari>0?c.fixSafariCookie(d.parent(b.target)):c.showDialog(d.parent(b.target))})},0)},fixSafariCookie:function(a){var b=d.attr(a,"data-iframe-url");window.showModalDialog(b,{name:""},"dialogWidth=870px;dialogHeight=580px")},autoShowGame:function(){var a=this;a.showDialog(d.get(".tb-isvgamemodule"))},showDialog:function(c){var e=d.attr(c,"data-iframe-url"),f=h(window).height(),i=580,j="<iframe src="+e+" width='872' height='580' frameborder='no' border='0' name='isvPage'></iframe>",k="",l='<div class="tm-j-close-isv-btn"></div>';f>650&&(i=650,k='<img src="//gtms01.alicdn.com/tps/i1/TB1GP0pGFXXXXaqXXXX86UL.pXX-870-70.png" width="870" alt="isv header"/>');var m=new g({prefixCls:"tm-isv-",elCls:"tm-shop-isv-dialog",width:872,height:i,closable:!1,closeOnClick:!0,closeAction:"destroy",elStyle:{position:6==a.UA.ie?"absolute":"fixed"},headerContent:k,bodyContent:j,footerContent:l,showCat:!1,mask:!0,zIndex:9999,align:{points:["cc","cc"]}});m.render(),m.show(),m.get("el").css("z-index",99999);var n=d.create("<div class='tm-isv-flower-mask'></div>");d.append(n,document.body),b.delegate(m.get("el"),"click",".tm-j-close-isv-btn",function(a){m.destroy(),d.remove(n)}),b.on(window,"resize",function(){})}};return l},{requires:["event","node","dom","ajax","overlay","./shopisv.css"]});