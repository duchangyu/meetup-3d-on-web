KISSY.add("tbc/tbar/1.4.0/third-party/xtemplate-shim/runtime/scope",function(t){function e(t,e){this.data=t||{},this.affix=e,this.root=this}return e.prototype={isScope:1,setParent:function(t){this.parent=t,this.root=t.root},getParent:function(){return this.parent},getRoot:function(){return this.root},set:function(t,e){this.affix||(this.affix={}),this.affix[t]=e},setData:function(t){this.data=t},getData:function(){return this.data},mix:function(e){this.affix||(this.affix={}),t.mix(this.affix,e)},has:function(t){var e=this.data,n=this.affix;return n&&t in n?!0:"object"==typeof e&&t in e},get:function(t){var e=this.data,n=this.affix;return n&&t in n?n[t]:"object"==typeof e&&t in e?e[t]:void 0},resolve:function(t,e){"."===t&&(t="this");var n,i,o,a,r,s=t.split("."),l=this;if("root"===s[0])s.shift(),l=l.root;else if(e)for(;l&&e--;)l=l.parent;var c=0;for(n=s.length;l;){for(r=1,o=l,i=0;n>i;i++)if(a=s[i],"this"!==a)if(o===l){if(!l.has(a)){r=0;break}o=l.get(a)}else{if("object"!=typeof o||!(a in o)){r=0;break}o=o[a]}else c=1;if(r)return o&&o.isScope&&(o=o.data),"function"==typeof o&&(o=o.call(this.data)),[o];if(c)break;l=l.parent}return!1}},e}),KISSY.add("tbc/tbar/1.4.0/third-party/xtemplate-shim/runtime/commands",function(t,e){function n(){var e,n,o,a="",r=arguments,s=0;for(n=r.length-1;n>=0&&!s;n--)o=r[n],"string"==typeof o&&o&&(a=o+"/"+a,s="/"===o.charAt(0));return e=i(t.filter(a.split("/"),function(t){return!!t}),!s).join("/"),(s?"/":"")+e||"."}function i(t,e){for(var n,i=0,o=t.length-1,a=[];o>=0;o--)n=t[o],"."!==n&&(".."===n?i++:i?i--:a[a.length]=n);if(e)for(;i--;i)a[a.length]="..";return a=a.reverse()}var o;return o={each:function(n,i){var o,a,r,s=i.params,l=s[0],c=s[2]||"xindex",d=s[1],u="";if(l)if(a=new e,t.isArray(l)){o=l.length;for(var m=0;o>m;m++)a.data=l[m],r=a.affix={xcount:o},r[c]=m,d&&(r[d]=l[m]),a.setParent(n),u+=i.fn(a)}else for(var f in l)a.data=l[f],r=a.affix={},r[c]=f,d&&(r[d]=l[f]),a.setParent(n),u+=i.fn(a);else i.inverse&&(u=i.inverse(n));return u},"with":function(t,n){var i=n.params,o=i[0],a="";if(o){var r=new e(o);r.setParent(t),a=n.fn(r)}else n.inverse&&(a=n.inverse(t));return a},"if":function(t,e){var n=e.params,i=n[0],o="";return i?e.fn&&(o=e.fn(t)):e.inverse&&(o=e.inverse(t)),o},set:function(t,e){return t.mix(e.hash),""},include:function(i,o){var a=o.params;if(!a||1!==a.length)return t.error("include must has one param"),"";if(o.hash){var r=new e(o.hash);r.setParent(i),i=r}var s=this.config.name,l=a[0];if("."===l.charAt(0)){if("unspecified"===s)return t.error("parent template does not have name for relative sub tpl name: "+l),"";l=n(s,"../",l)}var c=this.config.loader.call(this,l);return o=t.merge(this.config),o.name=l,o.commands=this.config.commands,o.macros=this.config.macros,this.invokeEngine(c,i,o)},macro:function(n,i){var o=i.params,a=o[0],r=o.slice(1),s=this.config.macros;if(!i.fn){var l={},c=s[a];c||t.error("can not find macro:"+name),t.each(c.paramNames,function(t,e){l[t]=r[e]});var d=new e(l);return c.fn.call(this,d)}return s[a]||(s[a]={paramNames:r,fn:i.fn}),""},parse:function(t,n){return o.include.call(this,new e,n)}}},{requires:["./scope"]}),KISSY.add("tbc/tbar/1.4.0/third-party/xtemplate-shim/runtime",function(t,e,n){function i(t){l.info(t)}function o(t,e){for(var n=e.split("."),i=t,o=n.length,a=0;o>a&&(i=i[n[a]],i);a++);return i}function a(e,n,i,a,r,s){var l,c=e.config,d=c.commands,u=o(d,a);if(u){try{l=u.call(e,n,i)}catch(m){t.error(m.message+': "'+a+'" at line '+r)}return{find:!0,value:l}}return s&&t.error("can not find command: "+a+'" at line '+r),{find:!1}}function r(e,n,o,a,r){var s,l=e.config,c=l.silent?i:t.error,d=n.resolve(o,a);return d===!1?c('can not find property: "'+o+'" at line '+r,"warn"):s=d[0],s}function s(n,i){var o=this;o.tpl=n,i=t.merge(u,i),i.commands=t.merge(i.commands,e),i.utils=d,i.macros=i.macros||{},this.config=i}var l,c=t.escapeHtml;l=t.getLogger?t.getLogger("s/xtemplate"):{info:function(){return t.log.apply(t,arguments)}};var d={runBlockCommand:function(e,n,a,r,s){var l=e.config,c=l.silent?i:t.error,d=l.commands,u=o(d,r);if(!u){if(a.params||a.hash)return t.error("can not find command: "+r+'" at line '+s),"";var m=n.resolve(r);m===!1?(c('can not find property: "'+r+'" at line '+s),m=""):m=m[0],u=d["if"],t.isArray(m)?u=d.each:"object"==typeof m&&(u=d["with"]),a.params=[m]}var f;try{f=u.call(e,n,a)}catch(b){t.error(b.message+': "'+r+'" at line '+s)}return f},renderOutput:function(t,e){return void 0===t&&(t=""),e&&t?c(t):t},getProperty:function(t,e,n,i,o){return r(t,e,n,i,o)},runInlineCommand:function(t,e,n,i,o){var r,s="";return r=a(t,e,n,i,o),r.find&&(s=r.value),s},getPropertyOrRunCommand:function(t,e,n,i,o,s){var l,c,d=n.hash||n.params;return c=a(t,e,n,i,s,d),c.find?l=c.value:d||(l=r(t,e,i,o,s)),l}},u={silent:!0,name:"unspecified",loader:function(e){var n=t.require(e);return n||t.error('template "'+e+'" does not exist, need to be required or used first!'),n}};return t.mix(s,{commands:e,utils:d,addCommand:function(t,n){e[t]=n},removeCommand:function(t){delete e[t]}}),s.prototype={constructor:s,invokeEngine:function(t,e,n){return new this.constructor(t,n).render(e,!0)},removeCommand:function(t){delete this.config.commands[t]},addCommand:function(t,e){this.config.commands[t]=e},render:function(e){var i=e;return i&&i.isScope||(i=new n(e)),this.tpl(i,t)}},s.Scope=n,s},{requires:["./runtime/commands","./runtime/scope"]}),KISSY.add("tbc/tbar/1.4.0/toolbar-xtpl",function(t,e,n,i){return function(){var t,e="",n=this.config,o=n.utils;"undefined"!=typeof i&&i.kissy&&(t=i);o.runBlockCommand,o.renderOutput,o.getProperty,o.runInlineCommand,o.getPropertyOrRunCommand;return e+='<div class="tb-toolbar tb-toolbar-shrinked" id="J_Toolbar" role="toolbar" data-spm="630"></div>\n'}}),KISSY.add("tbc/tbar/1.4.0/toolbar-list-xtpl",function(t,e,n,i){return function(){var t,e="",n=this.config,o=n.utils;"undefined"!=typeof i&&i.kissy&&(t=i);o.runBlockCommand,o.renderOutput,o.getProperty,o.runInlineCommand,o.getPropertyOrRunCommand;return e+='<ul class="tb-toolbar-list"></ul>'}}),KISSY.add("tbc/tbar/1.4.0/items/ww/ww-xtpl",function(t,e,n,i){return function(t){var e,n="",o=this.config,a=this,r=o.utils;"undefined"!=typeof i&&i.kissy&&(e=i);var s=(r.runBlockCommand,r.renderOutput),l=(r.getProperty,r.runInlineCommand,r.getPropertyOrRunCommand);n+='<li class="tb-toolbar-item" data-item="';var c=l(a,t,{},"name",0,1);n+=s(c,!1),n+='">\n    <span class="J_WangWang" data-nick="';var d=l(a,t,{},"nick",0,2);return n+=s(d,!0),n+='" data-icon="small" data-display="inline" data-encode="true"></span>\n    <a href="#" data-spm-click="gostr=/tbdetail;locaid=d1" class="tb-toolbar-item-hd tb-toolbar-item-hd-ww tb-toolbar-ww-offline" onclick="javascript:window.goldlog && goldlog.record && goldlog.record(\'/tbact.1212.12306.12\',\'\',\'\',\'H47641344\')">\n        <div class="tb-toolbar-item-icon">&#xf176;</div>\n        <div class="tb-toolbar-item-tip">\u5ba2\u670d<div class="tb-toolbar-item-arrow">\u25c6</div></div>\n    </a>\n    <div class="tb-toolbar-item-bd">\n    </div>\n</li>\n'}}),KISSY.add("tbc/tbar/1.4.0/items/ww/ww",function(t,e){function n(e){var n=e.split(".");return t.reduce(n,function(t,e){return"undefined"==typeof t?t:t[e]},window)}function i(t,e,i){if(n(t))i();else var o=setInterval(function(){n(t)&&(clearInterval(o),i())},e)}var o="";"undefined"!=typeof g_config&&(o=g_config.sellerNick);var a={nick:encodeURIComponent(o)},r="tb-toolbar-ww-offline";return{tpl:e,data:{nick:a.nick},listeners:{afterRender:function(e){var n=this,o=n.getItemEl(e);i("Light",200,function(){function i(){var a=t.one(".ww-light a",o);a&&a.length?a.hasClass("ww-online")?n.getItemHdEl(e).removeClass(r):a.hasClass("ww-offline")||setTimeout(i,200):setTimeout(i,200)}Light.light("#J_Toolbar"),t.one(".ww-light a",o)?i():setTimeout(i,200)}),setTimeout(function(){var e=t.one(".ww-light a",o);e.hasClass("ww-online")||e.hasClass("ww-offline")||Light.light("#J_Toolbar")},5e3)},click:function(e){t.one(".ww-light a",this.getItemEl(e)).fire("click")}},config:a}},{requires:["./ww-xtpl"]}),KISSY.add("tbc/tbar/1.4.0/items/feedback/feedback-xtpl",function(t,e,n,i){return function(t){var e,n="",o=this.config,a=this,r=o.utils;"undefined"!=typeof i&&i.kissy&&(e=i);var s=(r.runBlockCommand,r.renderOutput),l=(r.getProperty,r.runInlineCommand,r.getPropertyOrRunCommand);n+='<li class="tb-toolbar-item" data-item="';var c=l(a,t,{},"name",0,1);return n+=s(c,!1),n+='">\n    <a data-spm-click="gostr=/tbdetail;locaid=d5" href="#" class="tb-toolbar-item-hd" onclick="javascript:window.goldlog && goldlog.record && goldlog.record(\'/tbact.1212.12306.13\',\'\',\'\',\'H47641345\')">\n        <div class="tb-toolbar-item-icon">&#xf177;</div>\n        <div class="tb-toolbar-item-tip"><span class="tb-toolbar-item-tip-text">\u53cd\u9988</span><div class="tb-toolbar-item-arrow">\u25c6</div></div>\n    </a>\n</li>\n'}}),KISSY.add("tbc/tbar/1.4.0/items/feedback/feedback",function(t,e){var n={url:t.namespace("TB.Toolbar.gotop").url};return{tpl:e,data:{},listeners:{afterRender:function(t){var e=this;if(n.tip){var i=e.getItemEl(t);i.one(".tb-toolbar-item-tip-text").html(n.tip)}},click:function(e,i){var o=n.url;t.isFunction(n.url)?n.url(i):window.open(o)},message:{updateConfig:function(e,i){t.mix(n,i)}}},config:n}},{requires:["./feedback-xtpl"]}),KISSY.add("tbc/tbar/1.4.0/items/gotop/gotop-xtpl",function(t,e,n,i){return function(t){var e,n="",o=this.config,a=this,r=o.utils;"undefined"!=typeof i&&i.kissy&&(e=i);var s=(r.runBlockCommand,r.renderOutput),l=(r.getProperty,r.runInlineCommand,r.getPropertyOrRunCommand);n+='<li class="tb-toolbar-item" data-item="';var c=l(a,t,{},"name",0,1);return n+=s(c,!1),n+='">\n    <a data-spm-click="gostr=/tbdetail;locaid=d4" href="#" class="tb-toolbar-item-hd">\n        <div class="tb-toolbar-item-icon">&#xf178;</div>\n        <div class="tb-toolbar-item-tip"><span class="tb-toolbar-item-tip-text">\u9876\u90e8</span><div class="tb-toolbar-item-arrow">\u25c6</div></div>\n    </a>\n</li>\n'}}),KISSY.add("tbc/tbar/1.4.0/items/gotop/gotop",function(t,e,n){var i=e.all,o={scrollTop:1,animation:!1,easing:"easeBoth",duration:.5,complete:t.noop};return{tpl:n,data:{},listeners:{afterRender:function(t){var e=this;if(o.tip){var n=e.getItemEl(t);n.one(".tb-toolbar-item-tip-text").html(o.tip)}},click:function(){var t=window;o.animation?i(t).animate({scrollTop:o.scrollTop},o.duration,o.easing,o.complete):t.scrollTo(0,1)}},config:o}},{requires:["node","./gotop-xtpl"]}),KISSY.add("tbc/tbar/1.4.0/items/coupon/coupon-xtpl",function(t,e,n,i){return function(t){var e,n="",o=this.config,a=this,r=o.utils;"undefined"!=typeof i&&i.kissy&&(e=i);var s=(r.runBlockCommand,r.renderOutput),l=(r.getProperty,r.runInlineCommand,r.getPropertyOrRunCommand);n+='<li class="tb-toolbar-item tb-toolbar-item-coupon" data-item="';var c=l(a,t,{},"name",0,1);return n+=s(c,!1),n+='">\n    <a href="#" class="tb-toolbar-item-hd tb-toolbar-item-hd-coupon" onclick="javascript:window.goldlog && goldlog.record && goldlog.record(\'/tbact.1212.12306.11\',\'\',\'\',\'H47641322\')">\n        <div class="tb-toolbar-item-icon">&#xe603;</div>\n        <div class="tb-toolbar-item-tip tb-toolbar-item-tip-coupon">\u5e97\u94fa\u4f18\u60e0<div class="tb-toolbar-item-arrow">\u25c6</div></div>\n    </a>\n    <div class="tb-toolbar-item-hd-extra">\n        <div class="tb-toolbar-item-bubble tb-toolbar-item-bubble-coupon J_TBToolbarBubbleCoupon"><span class="tb-toolbar-item-bubble-txt">\u8be5\u5e97\u94fa\u53ef\u9886\u4f18\u60e0\u5238</span></br><a href="#" class="tb-toolbar-item-bubble-btn J_TBToolbarBubbleOpenCouponTgr" onclick="javascript:window.goldlog && goldlog.record && goldlog.record(\'/tbact.1212.12307.32\',\'\',\'\',\'H47641344\')">\u7acb\u5373\u9886\u53d6</a><span class="tb-toolbar-item-arrow">\u25c6</span><span class="tb-toolbar-item-bubble-saw"></span></div>\n    </div>\n    <div class="tb-toolbar-item-bd tb-toolbar-item-bd-coupon tb-toolbar-loading"></div>\n</li>\n'}}),KISSY.add("tbc/tbar/1.4.0/items/coupon/coupon",function(t,e,n){function i(){var t=l("meta[name=microscope-data]");if(t.length){var e=t.attr("content").match(/userid=\s*(\d+)/i);if(e&&e[1])return e[1]}return""}var o,a,r,s,l=e.all,c=!1,d=!1,u={init:function(e){var n=this,l=n.get("blackList");c=t.inArray("toolbar-coupon-promot",l),d=t.inArray("toolbar-coupon-promot-cdn",l),s=i(),o=n.getItemHdEl(e),a=o.next(".tb-toolbar-item-hd-extra"),r=n.getItemBdEl(e),s&&!c&&t.use("act20141212/c/2014-1212/sidebar/coupon/init",function(t,e){e.init({switcher_cdn:d,sellerId:s,success:function(t){"0"===t.code&&t.data&&"1"===t.data.sellerishavecoupon&&(a&&a.show(),a.all(".J_TBToolbarBubbleOpenCouponTgr").on("click",function(t){return t.preventDefault(),o.fire("click"),!1}))},error:function(){}})})},afterRender:function(){},click:function(t,e){{var n=this;e.currentTarget}n.expand(t)},expand:function(e){var n=this;r.show(),a&&(a.remove(),a=null),t.use("act20141212/c/2014-1212/sidebar/coupon/coupon",function(t,i){i.init({toolbar:n,itemName:e,sellerId:s,afterGetCoupons:function(){r.removeClass("tb-toolbar-loading")}})})},shrink:function(){r.hide(),r.html(""),r.addClass("tb-toolbar-loading")},message:{expand:function(t){this.expand(t)}}};return{tpl:n,config:{login:"click"},data:{isLogin:TB.Global.isLogin},listeners:u}},{requires:["node","./coupon-xtpl"]}),KISSY.add("tbc/tbar/1.4.0/items/cart/counter",function(t,e,n,i){function o(e){return c.userCookie&&"2"==c.userCookie.version?t.unparam(e,"&amp;"):t.unparam(e)}function a(e){var n=l(".J_ToolbarCartNum");return t.isNumber(e)?void(0>e?(w=-1===e,n.hide()):n.text(e).show()):void n.hide()}function r(t){if(t=t||0){var e={keys:"TCART_234_"+t+"_q"};n({type:"get",url:y,data:e,success:function(t){if(t){var n=h>=0?h:d?1:0;a(t[e.keys]),i.set("mt","ci="+t[e.keys]+"_"+n+(v?"&"+v:""),7,f)}else d()&&r()},dataType:"jsonp",cache:!1})}else n({type:"get",url:k+(m?"&appid="+m:""),success:a,dataType:"jsonp",cache:!1})}function s(){var t=l("#J_MiniCartNum"),e=0;if(t.length&&(e=parseInt(t.text(),10)),e>0)a(e);else if(d())b?1==h?a(g):r():r(i.get("unb"));else{var n=i.get("t");n?g>=0?a(g):r(n):a(0)}}var l=e.all,c=window,d=function(){var t=i.get("_nk_")||i.get("tracknick"),e=i.get("_l_g_"),n=i.get("lgc");return!!(e&&t||n)},u=!!~location.hostname.indexOf("daily.taobao.net"),m="g_config"in c&&"appId"in c.g_config?parseInt(c.g_config.appId):void 0,f=u?".daily.taobao.net":".taobao.com",b=o(i.get("mt")),p=b&&b.ci?b.ci.split("_"):[void 0,void 0],g=parseInt(p[0],10),h=parseInt(p[1],10),v=b?b.cp:void 0,k="//cart"+f+"/top_cart_quantity.htm?",y="//count."+(u?"config-vip.taobao.net:8888":"tbcdn.cn")+"/counter6",w=0>g;return{init:s,num:a}},{requires:["node","io","cookie"]}),KISSY.add("tbc/tbar/1.4.0/items/cart/cart-xtpl",function(t,e,n,i){return function(t){var e,n="",o=this.config,a=this,r=o.utils;"undefined"!=typeof i&&i.kissy&&(e=i);var s=(r.runBlockCommand,r.renderOutput),l=(r.getProperty,r.runInlineCommand,r.getPropertyOrRunCommand);n+='<li class="tb-toolbar-item tb-toolbar-item-cart" data-item="';var c=l(a,t,{},"name",0,1);return n+=s(c,!1),n+='">\n    <a href="#" data-spm-click="gostr=/tbdetail;locaid=d2" class="tb-toolbar-item-hd tb-toolbar-item-hd-cart J_TBToolbarCart" onclick="javascript:window.goldlog && goldlog.record && goldlog.record(\'/tbact.1212.12306.10\',\'\',\'\',\'H47641321\')">\n        <div class="tb-toolbar-item-icon tb-toolbar-item-icon-cart">&#xf179;</div>\n        <div class="tb-toolbar-item-label tb-toolbar-item-label-cart">\u8d2d\u7269\u8f66</div>\n        <div class="J_ToolbarCartNum tb-toolbar-item-badge-cart">0</div>\n		<div class="tb-toolbar-item-tip">\u6211\u7684\u8d2d\u7269\u8f66<div class="tb-toolbar-item-arrow">\u25c6</div></div>\n    </a>\n    <div class="tb-toolbar-item-bd tb-toolbar-mini-cart tb-toolbar-loading">\n    </div>\n</li>\n'}}),KISSY.add("tbc/tbar/1.4.0/items/cart/cart",function(t,e,n,i){var o=e.all,a=o("body");return{tpl:i,config:{login:"click"},data:{},listeners:{message:{fly:function(t,e){var n=this;e.$target=n.getItemHdEl(t),n.fly(e)},num:function(t,e){n.num(e.num)}},afterRender:function(t){var e=this,i=e.getItemEl(t),o=e.getItemBdEl(t);i.delegate("click",".J_ShrinkMiniCartToolBar",function(n){n.preventDefault(),"none"===o.css("display")?e.expand(t,{el:o}):e.shrink()}),a.on("toolbar:login",function(){n.init()}),n.init()},click:function(t,e){var n=e.currentTarget;this.expand(t,{el:o(n).next()})},expand:function(e,n){var i=this;n.el.show(),t.use("tbc/mini-cart/2.4.1/plugin/toolbar/index",function(t,o){o.init({container:n.el,success:function(){n.el.removeClass("tb-toolbar-loading")},error:function(t){n.el.removeClass("tb-toolbar-loading"),1===t.error&&(TB.Global.use("fn-login",function(t,o){o.Mini.popup(function(){i.expand(e,n)})}),i.shrink(e,n))}})})},shrink:function(t,e){e.el.hide(),e.el.html(""),e.el.addClass("tb-toolbar-loading")}}}},{requires:["node","./counter","./cart-xtpl"]}),KISSY.add("tbc/tbar/1.4.0/items/pk/pk-xtpl",function(t,e,n,i){return function(t){var e,n="",o=this.config,a=this,r=o.utils;"undefined"!=typeof i&&i.kissy&&(e=i);var s=(r.runBlockCommand,r.renderOutput),l=(r.getProperty,r.runInlineCommand,r.getPropertyOrRunCommand);n+='<li class="tb-toolbar-item" data-item="';var c=l(a,t,{},"name",0,1);return n+=s(c,!1),n+='">\n    <a data-spm-click="gostr=/tbdetail;locaid=d3" href="#" class="tb-toolbar-item-hd">\n        <div class="tb-toolbar-item-icon">&#xe602;</div>\n        <div class="tb-toolbar-item-tip">\u5bf9\u6bd4<div class="tb-toolbar-item-arrow">\u25c6</div></div>\n    </a>\n    <div class="tb-toolbar-item-bd tb-toolbar-loading">\n    </div>\n</li>'}}),KISSY.add("tbc/tbar/1.4.0/items/pk/pk",function(t,e,n){var i=(e.all,{}),o={login:"click"};return{tpl:n,data:{},config:o,listeners:{init:function(e){var n=this;t.use("pk/index",function(t,a){var r=n.getItemEl(e),s={trigger:n.getItemHdEl(e),wrapper:n.getItemBdEl(e)};o.ctItem&&(s.ctItem=o.ctItem),a.init(s),a.on("hide",function(){n.shrink("pk",{el:r})}),t.mix(i,{show:function(){a.show(),a.makePoint("pk.1.2")},add:function(t){a.addItem(t)},hide:function(){a.makePoint("pk.1.8")}})})},click:function(t){this.expand(t)},expand:function(t){this.getItemBdEl(t).show(),i.show&&i.show()},shrink:function(t){this.getItemBdEl(t).hide(),i.hide&&i.hide()},message:{add:function(t,e){i.add&&i.add(e)}}}}},{requires:["node","./pk-xtpl"]}),KISSY.add("tbc/tbar/1.4.0/items/qrcode/qrcode-xtpl",function(t,e,n,i){return function(t){var e,n="",o=this.config,a=this,r=o.utils;"undefined"!=typeof i&&i.kissy&&(e=i);var s=(r.runBlockCommand,r.renderOutput),l=(r.getProperty,r.runInlineCommand,r.getPropertyOrRunCommand);n+='<li class="tb-toolbar-item tb-toolbar-relative" data-item="';var c=l(a,t,{},"name",0,1);return n+=s(c,!1),n+='">\n    <a data-spm-click="gostr=/tbdetail;locaid=d6" href="#" class="tb-toolbar-item-hd">\n        <div class="tb-toolbar-item-icon">&#x3433;</div>\n    </a>\n    <div class="tb-toolbar-item-bd tb-toolbar-item-bd-left">\n    </div>\n</li>'}}),KISSY.add("tbc/tbar/1.4.0/items/qrcode/qrcode",function(t,e){var n={};return{tpl:e,data:{},listeners:{init:function(){},mouseenter:function(t){var e=this.getItemBdEl(t);if(n.loaded)e.show();else{e.css({height:"140px",width:"140px",marginTop:"-85px"});var i=g_config.QrcodeImgUrl;i&&(n.loaded=!0,e.html('<img src="'+i+'">').show())}},mouseleave:function(t){this.getItemBdEl(t).hide()}},config:n}},{requires:["./qrcode-xtpl"]}),KISSY.add("tbc/tbar/1.4.0/items/worthbuying/worthbuying-xtpl",function(t,e,n,i){return function(t){var e,n="",o=this.config,a=this,r=o.utils;"undefined"!=typeof i&&i.kissy&&(e=i);var s=(r.runBlockCommand,r.renderOutput),l=(r.getProperty,r.runInlineCommand,r.getPropertyOrRunCommand);n+='<li class="tb-toolbar-item tb-toolbar-item-worthbuying" data-item="';var c=l(a,t,{},"name",0,1);return n+=s(c,!1),n+='">\n    <a href="#" class="tb-toolbar-item-hd">\n        <div class="tb-toolbar-item-icon">&#xe605;</div>\n        <div class="tb-toolbar-item-tip">\u503c\u5f97\u4e70<div class="tb-toolbar-item-arrow">\u25c6</div></div>\n    </a>\n    <div class="tb-toolbar-item-bd"></div>\n</li>\n'}}),KISSY.add("tbc/tbar/1.4.0/items/worthbuying/worthbuying",function(t,e,n){var i,o,a,r=e.all;return{config:{login:"click"},tpl:n,data:{isLogin:TB.Global.isLogin},listeners:{click:function(t){this.expand(t)},expand:function(e){return i=this.getItemHdEl(e),o=this.getItemBdEl(e).show(),a?void a.refresh():void t.use("tbc/worthbuying/0.1.1/",function(t,e){e.init(o),e.refresh(),a=e,o.on("mousewheel",function(t){var e=t.currentTarget,n=t.delta,i=o.height(),a=e.scrollTop,s=r(e).children().height();(n>0&&0===a||0>n&&a+i>=s)&&t.halt()})})},shrink:function(t){var e=this.getItemBdEl(t);e.hide()}}}},{requires:["node","./worthbuying-xtpl"]}),KISSY.add("tbc/tbar/1.4.0/items/history/history-xtpl",function(t,e,n,i){return function(t){var e,n="",o=this.config,a=this,r=o.utils;"undefined"!=typeof i&&i.kissy&&(e=i);var s=(r.runBlockCommand,r.renderOutput),l=(r.getProperty,r.runInlineCommand,r.getPropertyOrRunCommand);n+='<li class="tb-toolbar-item tb-toolbar-history" data-item="';var c=l(a,t,{},"name",0,1);return n+=s(c,!1),n+='">\n    <a data-spm-click="gostr=/tbdetail;locaid=d5" href="#" class="tb-toolbar-item-hd" onclick="javascript:window.goldlog && goldlog.record && goldlog.record(\'/tbact.1212.12306.9\',\'\',\'\',\'H46985949\')">\n        <div class="tb-toolbar-item-icon">&#xe606;</div>\n        <div class="tb-toolbar-item-tip">\u6211\u7684\u8db3\u8ff9<div class="tb-toolbar-item-arrow">\u25c6</div></div>\n    </a>\n    <div class="tb-toolbar-item-bd tb-toolbar-loading">\n    </div>\n</li>\n'}}),KISSY.add("tbc/tbar/1.4.0/items/history/history",function(t,e,n){var i={login:"click"};return{tpl:n,config:i,data:{},listeners:{afterRender:function(t){{var e=this,n=e.getItemEl(t);e.getItemBdEl(t)}n.delegate("click",".J_Shrink",function(t){t.preventDefault(),e.shrink()})},click:function(t,n){var i=e.one(n.currentTarget);this.expand(t,{node:i.next()})},expand:function(e,n){var i=this,o=i.getItemBdEl(e);o.show(),t.use("act20141212/c/2014-1212/sidebar/history/",function(t,a){a.render(o,function(){o.removeClass("tb-toolbar-loading")},function(t){o.removeClass("tb-toolbar-loading"),t&&1===t.errorType&&(TB.Global.use("fn-login",function(t,o){o.Mini.popup(function(){i.expand(e,n),TB.Global.reload()})}),i.shrink(e,n))},i)})},shrink:function(e){var n=this,i=n.getItemBdEl(e);i.hide(),i.html(""),i.addClass("tb-toolbar-loading"),t.use("act20141212/c/2014-1212/sidebar/history/",function(t,e){e.detach()})}}}},{requires:["node","./history-xtpl"]}),KISSY.add("tbc/tbar/1.4.0/items/help/help-xtpl",function(t,e,n,i){return function(t){var e,n="",o=this.config,a=this,r=o.utils;"undefined"!=typeof i&&i.kissy&&(e=i);var s=(r.runBlockCommand,r.renderOutput),l=(r.getProperty,r.runInlineCommand,r.getPropertyOrRunCommand);n+='<li class="tb-toolbar-item" data-item="';var c=l(a,t,{},"name",0,1);return n+=s(c,!1),n+='">\n    <a href="#" class="tb-toolbar-item-hd">\n        <div class="tb-toolbar-item-icon">&#xe601;</div>\n        <div class="tb-toolbar-item-tip"><span class="tb-toolbar-item-tip-text">\u5e2e\u52a9</span><div class="tb-toolbar-item-arrow">\u25c6</div></div>\n    </a>\n</li>\n'}}),KISSY.add("tbc/tbar/1.4.0/items/help/help",function(t,e,n){var i=(e.all,{url:""});return{tpl:n,data:{},listeners:{afterRender:function(t){var e=this;if(i.tip){var n=e.getItemEl(t);n.one(".tb-toolbar-item-tip-text").html(i.tip)}},click:function(e,n){var o=i.url;t.isFunction(i.url)&&(o=i.url(n)),window.goldlog&&goldlog.record&&goldlog.record("/tbact.1212.12307.28","","","H47641350"),window.open(o)}},config:i}},{requires:["node","./help-xtpl"]}),KISSY.add("tbc/tbar/1.4.0/toolbar-config",function(t,e,n,i,o,a,r,s,l,c,d){var u=!!~location.hostname.indexOf("daily.taobao.net"),m=u?"//g-assets.daily.taobao.net":"//g.alicdn.com";return t.config({modules:{"pk/index":{requires:["./index.css"]}},packages:{pk:{base:m+"/tb/pk/0.1.0/",ignorePackageNameInUri:!0},act20141212:{base:m+"/tb/activity/1.6.0/",ignorePackageNameInUri:!0,debug:!0}}}),{ww:e,feedback:n,gotop:i,coupon:o,cart:a,pk:r,qrcode:s,worthbuying:l,history:c,help:d}},{requires:["./items/ww/ww","./items/feedback/feedback","./items/gotop/gotop","./items/coupon/coupon","./items/cart/cart","./items/pk/pk","./items/qrcode/qrcode","./items/worthbuying/worthbuying","./items/history/history","./items/help/help"]}),KISSY.add("tbc/tbar/1.4.0/items/a11y/a11y",function(t,e){function n(t){9==t.keyCode&&a++,1==a&&(i=Date.parse(new Date)),a>10&&2e4>Date.parse(new Date)-i&&(r.detach("keydown",n),window.goldlog&&goldlog.record&&goldlog.record("/cact.1015.1","","url="+encodeURIComponent(location.host+location.pathname),"H46777383"))}var i,o=e.all,a=0,r=o(window);r.on("keydown",n)},{requires:["node"]}),KISSY.add("tbc/tbar/1.4.0/index",function(t,e,n,i,o,a,r,s,l){var c="expand",d="shrink",u="afterShrink",m="tb-toolbar-item-hd-active",f=".tb-toolbar-item-hd",b=".tb-toolbar-item-bd",p=n.all,g=p("body"),h=!1,v=e.extend({initializer:function(){if(!h&&(h=!0,!this.hostIsInBlackList())){t.namespace("TB.Toolbar",!0).toolbar=this;var e=new a(r).render({}),n=new a(s).render({}),i=p(e);this.el=i;var o=this.get("items"),c=this,d=["black"],u=this.get("style");t.inArray(u,d)&&this.el.addClass("tb-toolbar-"+u),t.UA.ie<=8&&document.body.clientWidth<1366&&this.el.addClass("tb-toolbar-mini"),this.get("expandToRight")&&this.el.addClass("tb-toolbar-right");var m=c.get("defaultSpacing"),f=c.get("blackList");t.each(o,function(e,o){var r=p('<div class="tb-toolbar-space"></div>');r.css(e.topSpacing?{height:e.topSpacing}:m[o]),i.append(r);var s=p(n),d=e.list?e.list.length:0;t.each(e.list||[],function(n,i){s.addClass("tb-toolbar-list-with-"+n);var o,r=n;if(t.isObject(n)&&(r=n.type,o=n.css),!t.inArray(r,f)){var u=l[r];if(u){var m=u.tpl;if(m){var b=u.data||{};b.name=r;var h=new a(m).render(b),n=p(h);c.items.push(r),c.set(r,n),o&&n.css(o),s.append(n),e.splitLine&&i!=d-1&&s.append('<li class="tb-toolbar-item-split"></li>')}var v=u.listeners,k=v&&v.init;k&&k.apply(c,[r]);var y=v&&v.message;if(t.isPlainObject(y))t.each(y,function(e,n){var i=["toolbar",r,n].join(":");g.on(i,t.bind(e,c,r))});else if(t.isFunction(y)){var w=["toolbar",r,"message"].join(":");g.on(w,t.bind(y,c,r))}}}}),e.css&&s.css(e.css),i.append(s)}),this.set("created",!0)}},destructor:function(){this.el.remove(),this.set("created",!1),this.set("rendered",!1),this.el=null},items:[],render:function(){if(!this.get("rendered")){p(this.get("render")).append(this.el),this.set("rendered",!0),this.binding();var e=this.items,n=this;t.each(e,function(t){var e=l[t].listeners,i=e&&e.afterRender;i&&i.apply(n,[t])})}},binding:function(){function t(t,e){function i(){var i=e.type,o=l[t].listeners;o&&o[i]&&o[i].apply(n,[t,e])}v.config(t).login!==e.type||TB.Global.isLogin?i():TB.Global.use("fn-login",function(t,e){e.Mini.popup(function(){g.fire("toolbar:login"),i()})})}var e=this.el,n=this;e.delegate("click",".tb-toolbar-item-hd",function(e){e.preventDefault();var n=e.currentTarget,i=p(n).parent().attr("data-item");t(i,e)}),e.delegate("mouseenter mouseleave",".tb-toolbar-item",function(e){e.preventDefault();var n=e.currentTarget,i=p(n).attr("data-item");t(i,e)}),p(document).on("click",function(t){e.contains(t.target)||e.equals(t.target)||n.shrink()})},getExpanded:function(){return this.get("expanded").item},getItemEl:function(t){return this.get(t)},getItemHdEl:function(t){var e=this.getItemEl(t);return e&&e.all(f)},getItemBdEl:function(t){var e=this.getItemEl(t);return e&&e.all(b)},fly:function(e){var n=e.pos;if(e.trigger){var i=p(e.trigger).offset();i&&(n=i)}var o=e.$target,a=e.pic?e.pic.replace(/_(sum|\d{2,5}x\d{2,5})\.jpg$/,"_50x50.jpg"):"//g.alicdn.com/s.gif",r=p('<div class="tb-toolbar-flyer" style="background: url('+a+') no-repeat 50% 50%;"></div>').css("left",n.left).css("top",n.top).appendTo("body");t.use(["anim","ua"],function(t,n,i){var a=o.offset();n(r,{left:a.left-100,top:a.top},.5,"easeNone",function(){var t={left:a.left+10};(!i.ie||i.ie>8)&&(t.opacity=0),n(r,t,.8,"easeNone",function(){r.remove(),e.success&&e.success()}).run()}).run()})},expand:function(t,e){var n=this.get("expanded"),i=n.item;if(i&&(i!==t?this.shrink(null,null,!0):this.shrink()),t!==i){this.getItemHdEl(t).addClass(m);var a=l[t].listeners[c];a&&a.apply(this,[t,e]),this.set("expanded",{item:t,data:e}),this.el.removeClass("tb-toolbar-shrinked"),this.get("expandToRight")&&(o.stop(this.el,!0),new o(this.el,{right:this.getItemBdEl(t).outerWidth()},.3,"easeOut",function(){},!0).run())}},shrink:function(t,e,n){var i=this.get("expanded"),a=i.item;if(a){var r=i.data;this.getItemHdEl(a).removeClass(m);var s=l[a].listeners[d];this.set("expanded",{}),this.el.addClass("tb-toolbar-shrinked");var c=this;if(this.get("expandToRight")&&!n)return o.stop(this.el,!0),void new o(this.el,{right:0},.3,"easeOut",function(){s&&s.apply(c,[a,r]),g.fire("toolbar:shrink")},!0).run();s&&s.apply(this,[a,r]),g.fire("toolbar:shrink")}},afterShrink:function(){var t=this.get("shrinking"),e=t.item;if(e){var n=t.data,i=l[e].listeners[u];i&&i.apply(this,[e,n]),this.set("shrinking",{}),g.fire("toolbar:afterShrink")}},hostIsInBlackList:function(){var e=location.host,n=this.get("hostBLackList");return t.inArray(e,n)}},{ATTRS:{render:{value:document.body},created:{value:!1},rendered:{value:!1},expanded:{value:{}},shrinking:{value:{}},items:{value:[{list:["worthbuying","cart","history","coupon"],splitLine:!0},{list:["feedback","gotop"]}]},defaultSpacing:{value:[{height:"25%"},{height:"7%"}]},style:{value:""},expandToRight:{value:!0},blackList:{value:[]},hostBLackList:{value:["g.taobao.com","guang.taobao.com","i.taobao.com","shoucang.taobao.com","favorite.taobao.com","lu.taobao.com","tw.taobao.com","sea.taobao.com","hk.taobao.com","cun.taobao.com"]}},ITEMS:l,register:function(t,e){return l[t]=e,l},config:function(){if(t.isObject(arguments[0]))return void t.each(arguments[0],function(e,n){var i=l[n];if(i){var o=i.config||{};e&&(i.config=t.mix(o,e))}});var e=arguments[0],n=arguments[1],i=l[e];if(i){var o=i.config||{};return n&&(i.config=t.mix(o,n)),o}}});if(window.TB){var k=t.namespace("TB.Toolbar",!0),y=k.auto,w=k.close,x=k.use;if((y&&!t.isFunction(y)||t.isFunction(y)&&y())&&(k.toolbar=new v(k.items)),w&&!t.isFunction(w)||t.isFunction(w)&&w()){var I=t.noop;v=I,v.prototype={expand:I,shrink:I,render:I,getExpanded:I,getItemHdEl:I,getItemBdEl:I,getItemEl:I},v.config=I}x&&(t.isFunction(x)&&(x=x(v)),t.use(x))}return v},{requires:["base","node","dom","anim","./third-party/xtemplate-shim/runtime","./toolbar-xtpl","./toolbar-list-xtpl","./toolbar-config","./items/a11y/a11y","./index.css"]});